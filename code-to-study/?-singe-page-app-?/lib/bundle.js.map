{
  "version": 3,
  "sources": [
    "bundle.js"
  ],
  "names": [
    "Lazyframe",
    "settings",
    "elements",
    "defaults",
    "vendor",
    "undefined",
    "id",
    "src",
    "thumbnail",
    "title",
    "apikey",
    "initialized",
    "parameters",
    "y",
    "debounce",
    "lazyload",
    "initinview",
    "onLoad",
    "l",
    "onAppend",
    "onThumbnailLoad",
    "img",
    "constants",
    "regex",
    "youtube",
    "vimeo",
    "vine",
    "condition",
    "m",
    "length",
    "s",
    "endpoints",
    "response",
    "r",
    "items",
    "snippet",
    "thumb",
    "thumbnails",
    "url",
    "maxres",
    "standard",
    "thumbnail_url",
    "init",
    "Object",
    "assign",
    "selector",
    "document",
    "querySelectorAll",
    "i",
    "loop",
    "scroll",
    "el",
    "HTMLElement",
    "classList",
    "contains",
    "lazyframe",
    "setup",
    "addEventListener",
    "appendChild",
    "iframe",
    "call",
    "build",
    "api",
    "attr",
    "Array",
    "prototype",
    "slice",
    "apply",
    "attributes",
    "filter",
    "att",
    "value",
    "reduce",
    "obj",
    "curr",
    "name",
    "indexOf",
    "split",
    "options",
    "offsetTop",
    "extractParams",
    "match",
    "params",
    "hasAutoplay",
    "useApi",
    "send",
    "err",
    "data",
    "_l",
    "cb",
    "endpoint",
    "request",
    "XMLHttpRequest",
    "open",
    "onload",
    "status",
    "JSON",
    "parse",
    "responseText",
    "onerror",
    "height",
    "window",
    "innerHeight",
    "count",
    "initElement",
    "add",
    "click",
    "forEach",
    "onScroll",
    "up",
    "lastY",
    "scrollY",
    "removeEventListener",
    "t",
    "func",
    "wait",
    "immediate",
    "timeout",
    "context",
    "args",
    "arguments",
    "later",
    "callNow",
    "clearTimeout",
    "setTimeout",
    "loadImage",
    "getIframe",
    "style",
    "backgroundImage",
    "children",
    "docfrag",
    "createDocumentFragment",
    "titleNode",
    "createElement",
    "className",
    "innerHTML",
    "push",
    "iframeNode",
    "setAttribute",
    "scriptNode"
  ],
  "mappings": "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",
  "file": "bundle.js",
  "sourceRoot": "../src",
  "sourcesContent": [
    "const Lazyframe = () => {\n\n  let settings;\n\n  const elements = [];\n\n  const defaults = {\n    vendor: undefined,\n    id: undefined,\n    src: undefined,\n    thumbnail: undefined,\n    title: undefined,\n    apikey: undefined,\n    initialized: false,\n    parameters: undefined,\n    y: undefined,\n    debounce: 250,\n    lazyload: true,\n    initinview: false,\n    onLoad: (l) => {},\n    onAppend: (l) => {},\n    onThumbnailLoad: (img) => {}\n  };\n\n  const constants = {\n    regex: {\n      youtube: /(?:youtube\\.com\\/\\S*(?:(?:\\/e(?:mbed))?\\/|watch\\?(?:\\S*?&?v\\=))|youtu\\.be\\/)([a-zA-Z0-9_-]{6,11})/,\n      vimeo: /vimeo\\.com\\/(?:video\\/)?([0-9]*)(?:\\?|)/,\n      vine: /vine.co\\/v\\/(.*)/\n    },\n    condition: {\n      youtube: (m) => (m && m[1].length == 11) ? m[1] : false,\n      vimeo: (m) => (m && m[1].length === 9 || m[1].length === 8) ? m[1] : false,\n      vine: (m) => (m && m[1].length === 11) ? m[1] : false\n    },\n    src: {\n      youtube: (s) => `https://www.youtube.com/embed/${s.id}/?${s.parameters}`,\n      vimeo: (s) => `https://player.vimeo.com/video/${s.id}/?${s.parameters}`,\n      vine: (s) => `https://vine.co/v/${s.id}/embed/simple`\n    },\n    endpoints: {\n      youtube: (s) => `https://www.googleapis.com/youtube/v3/videos?id=${s.id}&key=${s.apikey}&fields=items(snippet(title,thumbnails))&part=snippet`,\n      vimeo: (s) => `https://vimeo.com/api/oembed.json?url=https%3A//vimeo.com/${s.id}`,\n      vine: (s) => `https://vine.co/oembed.json?url=https%3A%2F%2Fvine.co%2Fv%2F${s.id}`\n    },\n    response: {\n      youtube: {\n        title: (r) => r.items['0'].snippet.title,\n        thumbnail: (r) => {\n          let thumb = r.items[\"0\"].snippet.thumbnails;\n          let url = thumb.maxres ? thumb.maxres.url : thumb.standard.url;\n          return url;\n        }\n      },\n      vimeo: {\n        title: (r) => r.title,\n        thumbnail: (r) => r.thumbnail_url\n      },\n      vine: {\n        title: (r) => r.title,\n        thumbnail: (r) => r.thumbnail_url\n      }\n    }\n  };\n\n  function init(elements, ...args) {\n    settings = Object.assign({}, defaults, args[0]);\n\n    if (typeof elements === 'string') {\n\n      const selector = document.querySelectorAll(elements);\n      for (let i = 0; i < selector.length; i++) {\n        loop(selector[i]);\n      }\n\n    } else if (typeof elements.length === 'undefined'){\n      loop(elements);\n\n    } else if (elements.length > 1) {\n\n      for (let i = 0; i < elements.length; i++) {\n        loop(elements[i]);\n      }\n\n    } else {\n      loop(elements[0]);\n    }\n\n    if (settings.lazyload) {\n      scroll();\n    }\n\n  }\n\n  function loop(el) {\n\n    if(el instanceof HTMLElement === false ||\n       el.classList.contains('lazyframe--loaded')) return;\n\n    const lazyframe = {\n      el: el,\n      settings: setup(el),\n    };\n\n    lazyframe.el.addEventListener('click', () => {\n      lazyframe.el.appendChild(lazyframe.iframe);\n\n      const iframe = el.querySelectorAll('iframe');\n      lazyframe.settings.onAppend.call(this, iframe[0]);\n    });\n\n    if (settings.lazyload) {\n      build(lazyframe);\n    } else {\n      api(lazyframe, !!lazyframe.settings.thumbnail);\n    }\n\n  }\n\n  function setup(el) {\n\n    const attr = Array.prototype.slice.apply(el.attributes)\n     .filter(att => att.value !== '')\n     .reduce((obj, curr) => {\n        let name = curr.name.indexOf('data-') === 0 ? curr.name.split('data-')[1] : curr.name;\n        obj[name] = curr.value;\n        return obj;\n     }, {});\n\n    const options = Object.assign({},\n      settings,\n      attr,\n      {\n        y: el.offsetTop,\n        parameters: extractParams(attr.src)\n      }\n    );\n\n    if (options.vendor) {\n      const match = options.src.match(constants.regex[options.vendor]);\n      options.id = constants.condition[options.vendor](match);\n    }\n\n    return options;\n\n  }\n\n  function extractParams(url) {\n    let params = url.split('?');\n\n    if (params[1]) {\n      params = params[1];\n      const hasAutoplay = params.indexOf('autoplay') !== -1;\n      return hasAutoplay ? params : params + '&autoplay=1';\n\n    } else {\n      return 'autoplay=1';\n    }\n\n  }\n\n  function useApi(settings) {\n\n    if (!settings.vendor) return false;\n\n    if (!settings.title || !settings.thumbnail) {\n      if (settings.vendor === 'youtube') {\n        return !!settings.apikey;\n      } else {\n        return true;\n      }\n\n    } else {\n      return false;\n    }\n\n  }\n\n  function api(lazyframe) {\n\n    if (useApi(lazyframe.settings)) {\n      send(lazyframe, (err, data) => {\n        if (err) return;\n\n        const response = data[0];\n        const _l = data[1];\n\n        if (!_l.settings.title) {\n          _l.settings.title = constants.response[_l.settings.vendor].title(response);\n        }\n        if (!_l.settings.thumbnail) {\n          const url = constants.response[_l.settings.vendor].thumbnail(response);\n          _l.settings.thumbnail = url;\n          lazyframe.settings.onThumbnailLoad.call(this, url);\n        }\n        build(_l, true);\n\n      });\n\n    }else{\n      build(lazyframe, true);\n    }\n\n  }\n\n  function send(lazyframe, cb) {\n\n    const endpoint = constants.endpoints[lazyframe.settings.vendor](lazyframe.settings);\n    const request = new XMLHttpRequest();\n\n    request.open('GET', endpoint, true);\n\n    request.onload = function() {\n      if (request.status >= 200 && request.status < 400) {\n        const data = JSON.parse(request.responseText);\n        cb(null, [data, lazyframe]);\n      } else {\n        cb(true);\n      }\n    };\n\n    request.onerror = function() {\n      cb(true);\n    };\n\n    request.send();\n\n  }\n\n  function scroll() {\n\n    const height = window.innerHeight;\n    let count = elements.length;\n    const initElement = (el, i) => {\n      el.settings.initialized = true;\n      el.el.classList.add('lazyframe--loaded');\n      count--;\n      api(el);\n\n      if (el.settings.initinview) {\n        el.el.click();\n      }\n\n      el.settings.onLoad.call(this, el);\n    }\n\n    elements\n      .filter(el => el.settings.y < height)\n      .forEach(initElement);\n\n    const onScroll = debounce(() => {\n\n      up = lastY < window.scrollY;\n      lastY = window.scrollY;\n\n      if (up) {\n        elements\n          .filter(el => el.settings.y < (height + lastY) && el.settings.initialized === false)\n          .forEach(initElement);\n      }\n\n      if (count === 0) {\n        window.removeEventListener('scroll', onScroll, false);\n      }\n\n    }, settings.debounce);\n\n    let lastY = 0;\n    let t = false, up = false;\n    window.addEventListener('scroll', onScroll, false);\n\n    function debounce(func, wait, immediate) {\n      let timeout;\n      return function() {\n        let context = this, args = arguments;\n        let later = function() {\n          timeout = null;\n          if (!immediate) func.apply(context, args);\n        };\n        let callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) func.apply(context, args);\n      };\n    };\n\n  }\n\n  function build(lazyframe, loadImage) {\n\n    lazyframe.iframe = getIframe(lazyframe.settings);\n\n    if (lazyframe.settings.thumbnail && loadImage) {\n      lazyframe.el.style.backgroundImage = `url(${lazyframe.settings.thumbnail})`;\n    }\n\n    if (lazyframe.settings.title && lazyframe.el.children.length === 0) {\n      const docfrag = document.createDocumentFragment(),\n            titleNode = document.createElement('span');\n\n      titleNode.className = 'lazyframe__title';\n      titleNode.innerHTML = lazyframe.settings.title;\n      docfrag.appendChild(titleNode);\n\n      lazyframe.el.appendChild(docfrag);\n    }\n\n    if (!settings.lazyload) {\n      lazyframe.el.classList.add('lazyframe--loaded');\n      lazyframe.settings.onLoad.call(this, lazyframe);\n      elements.push(lazyframe);\n    }\n\n    if (!lazyframe.settings.initialized) {\n      elements.push(lazyframe);\n    }\n\n  }\n\n  function getIframe(settings) {\n\n    const docfrag = document.createDocumentFragment(),\n          iframeNode = document.createElement('iframe');\n\n    if (settings.vendor) {\n      settings.src = constants.src[settings.vendor](settings);\n    }\n\n    iframeNode.setAttribute('id', `lazyframe-${settings.id}`);\n    iframeNode.setAttribute('src', settings.src);\n    iframeNode.setAttribute('frameborder', 0);\n    iframeNode.setAttribute('allowfullscreen', '');\n\n    if (settings.vendor === 'vine') {\n      const scriptNode = document.createElement('script');\n      scriptNode.setAttribute('src', 'https://platform.vine.co/static/scripts/embed.js');\n      docfrag.appendChild(scriptNode);\n    }\n\n    docfrag.appendChild(iframeNode);\n    return docfrag;\n\n  }\n\n  return init;\n\n}\n\n// const lf = Lazyframe();\n\n// export default lf;\n\nlet elements = document.querySelectorAll('.lazyframe');\n\n    lazyframe(elements, {\n      apikey: 'AIzaSyBhloBPcVZBYHq4mUJ1qzjiT9Ri_LyjWC4' // Sorry, will only work on this domain\n    });\n\n"
  ]
}
